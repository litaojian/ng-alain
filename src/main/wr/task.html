<style>
    .link {
        padding: 0 4px;
    }
    
    .overflow {
        width: 98%;
        display: block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>
<nz-card [nzBordered]="false">
    <ng-template #body>
        <form id="queryForm" zx-formInput [formData]="queryForm" nz-form #f="ngForm" (ngSubmit)="onQueryFormSubmit(f)" [nzLayout]="'inline'">
            <input type="hidden" value="queryListByUser" name="filter" />
            <input type="hidden" value="${request.status}$" name="status" />
            <input type="hidden" value="${request.plans}$" name="plans" />
            <input type="hidden" value="5" name="pageSize" />
            <div nz-row [nzGutter]="24">
                <div nz-col [nzSpan]="6" class="mb-md">
                    <div nz-form-item class="d-flex">
                        <div nz-form-label><label for="beginDate">开始日期</label></div>
                        <div nz-form-control class="flex-1">
                            <nz-datepicker name="beginDate" [(ngModel)]="queryForm['beginDate']" data-value="${request.beginDate}$" id="beginDate" [nzSize]="'large'" [nzPlaceHolder]="'开始日期'" class="d-block"></nz-datepicker>
                        </div>
                    </div>
                </div>
                <div nz-col [nzSpan]="6" class="mb-md">
                    <div nz-form-item class="d-flex">
                        <div nz-form-label><label for="endDate">结束日期</label></div>
                        <div nz-form-control class="flex-1">
                            <nz-datepicker name="endDate" [(ngModel)]="queryForm['endDate']" data-value="${request.endDate}$" id="endDate" [nzSize]="'large'" [nzPlaceHolder]="'结束日期'" class="d-block"></nz-datepicker>
                        </div>
                    </div>
                </div>
                <div nz-col [nzSpan]="4" class="mb-md">
                    <div nz-form-item class="d-flex">
                        <div nz-form-label><label for="">姓名</label></div>
                        <div nz-form-control class="flex-1">
                            <nz-input [(ngModel)]="queryForm['assignedto']" name="assignedto" data-value="${request.user}$" [nzSize]="'large'" [nzPlaceHolder]="'姓名'" nzId="assignedto"></nz-input>
                        </div>
                    </div>
                </div>
                <div nz-col [nzSpan]="expandForm ? 24 : 6" class="mb-md" [class.text-right]="expandForm">
                    <button nz-button type="submit" [nzType]="'primary'" [nzLoading]="loading" [nzSize]="'large'" id="queryBtn">查询</button>
                    <a (click)="expandForm=!expandForm">
	                    {{expandForm ? '收起' : '展开'}}
	                    <i class="anticon" [class.anticon-down]="!expandForm" [class.anticon-up]="expandForm"></i>
	                </a>
                </div>
            </div>
        </form>
        <div class="mb-md">
        </div>
        <nz-table #nzTable class="fixedLayout" [nzAjaxData]="tableData" nzShowTotal="true" [nzTotal]="totalCount" [nzPageIndex]="pageIndex" [nzPageSize]="pageSize" [nzLoading]="loading" (nzPageIndexChange)="onPageLinkClick($event)" [nzBordered]="true">
            <thead nz-thead>
                <tr>
                    <th nz-th class="wd50">编号</th>
                    <th nz-th class="wd80">负责人</th>
                    <th nz-th class="wd50">类别</th>
                    <th nz-th class="wd300">任务名称</th>
                    <th nz-th class="wd60">状态</th>
                    <th nz-th class="wd80">交付日期</th>
                    <th nz-th class="wd80">完成日期</th>
                </tr>

            </thead>
            <tbody nz-tbody>
                <tr nz-tbody-tr *ngFor="let row of nzTable.data; let rowNum = index;">
                    <td nz-td class="center">{{row.taskid}}</td>
                    <td nz-td class="left">{{row.username}}</td>
                    <td nz-td class="left">{{row.typename}}</td>
                    <td nz-td class="left">
                        <div *ngIf="row.projectname" class="overflow" [title]="row.projectname">{{row.projectname}}</div>
                        <div *ngIf="row.taskname" class="overflow" [title]="row.taskname">{{row.taskname}}</div>
                        <div>预估: {{row.estimate}}, 花费: {{row.consumed}},还需: {{row.left}}</div>
                    </td>
                    <td nz-td class="left">{{row.statusname}}</td>
                    <td nz-td class="left">{{row.deadline | date:'yyyy-MM-dd'}}</td>
                    <td nz-td class="left">{{row.finishedDate | date:'yyyy-MM-dd'}}</td>
                </tr>
            </tbody>
        </nz-table>
    </ng-template>
</nz-card>